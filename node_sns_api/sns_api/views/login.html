<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>API ì„œë²„</title>
    <style>
      .input-group label { width: 200px; display: inline-block; }
    </style>
  </head>
  <body>
    <!-- ğŸ‘‡ 1. ë¡œê·¸ì¸ O => ë„ë©”ì¸ ë“±ë¡ í™”ë©´ -->
    {% if user and user.id %}
      <span class="user-name">ì•ˆë…•í•˜ì„¸ìš”! {{user.nick}}ë‹˜</span>
      <a href="/auth/logout">
        <button>ë¡œê·¸ì•„ì›ƒ</button>
      </a>
      <fieldset>
        <legend style="font-weight: bold;">ë„ë©”ì¸ ë“±ë¡</legend>
        <form action="/domain" method="post">   <!-- ğŸ‘ˆ ë„ë©”ì¸(+clientSecret) ìƒì„± -->
          <div>
            <span style="font-weight: bold;">ìœ í˜•</span>:
            <label for="type-free">ë¬´ë£Œ</label>
            <input type="radio" id="type-free" name="type" value="free" checked> <!-- ë””í´íŠ¸ë¡œ "ë¬´ë£Œ" ì„ íƒ -->
            <label for="type-premium">í”„ë¦¬ë¯¸ì—„</label>
            <input type="radio" id="type-premium" name="type" value="premium">
          </div>
          <div style="display: inline-block;">
            <label for="host" style="font-weight: bold;">ë„ë©”ì¸</label>:
            <input type="text" id="host" name="host" placeholder="ex) naver.com">
          </div>
          <button style="margin-left: 10px;">ì €ì¥</button>                 <!-- ê¸°ë³¸ë™ì‘: type="submit" -->
        </form>
      </fieldset>
      <table border="1">
        <thead>
            <tr>
                <th>ë„ë©”ì¸ ì£¼ì†Œ</th>
                <th>íƒ€ì…</th>
                <th>í´ë¼ì´ì–¸íŠ¸ ë¹„ë°€í‚¤</th>
              </tr>
        </thead>
        <tbody>
        {% for domain in domains %}                 <!-- controllers/index.js - renderLogin -->
            <tr>
                <td>{{domain.host}}</td>
                <td>{{domain.type}}</td>
                <td>{{domain.clientSecret}}</td>        <!-- ğŸ‘ˆ clientSecret ëœë”ë§ -->
            </tr>
        {% endfor %}
        </tbody>
      </table>
    <!-- ğŸ‘‡ 2. ë¡œê·¸ì¸ X => ë¡œê·¸ì¸ í™”ë©´ -->
    {% else %}
      <form action="/auth/login" id="login-form" method="post"> <!-- ğŸ‘ˆ ë¡œê·¸ì¸ ë¡œì§ (passport) -->
        <h2>NodeBird ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•˜ì„¸ìš”.</h2>
        <div class="input-group">
          <label for="email">ì´ë©”ì¼</label>
          <input id="email" type="email" name="email" required autofocus>
        </div>
        <div class="input-group">
          <label for="password">ë¹„ë°€ë²ˆí˜¸</label>
          <input id="password" type="password" name="password" required>
        </div>
        <div>íšŒì›ê°€ì…ì€ ì›¹ì„œë¹„ìŠ¤(localhost:8001)ì—ì„œ í•˜ì„¸ìš”.</div>
        <button id="login" type="submit">ë¡œê·¸ì¸</button>
      </form>
      <script>
        window.onload = () => {
          if (new URL(location.href).searchParams.get('error')) {
            alert(new URL(location.href).searchParams.get('error'));
          }
        };
      </script>
    {% endif %}
  </body>
</html>